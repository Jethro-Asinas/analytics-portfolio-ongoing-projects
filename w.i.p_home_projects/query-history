CREATE TABLE realtor_house_listings (broker_id varchar(100), status varchar(100), price varchar(100), bed varchar(100), bath varchar(100), acres varchar(100), street_id varchar(100), city varchar(100), state varchar(100), zip_code varchar(100), house_size varchar(100), prev_sold_date varchar(100));

SELECT * FROM realtor_house_listings

ALTER TABLE realtor_house_listings
ALTER COLUMN broker_id TYPE integer
USING CAST(CAST(price as numeric) AS integer);

ALTER TABLE realtor_house_listings
ALTER COLUMN price TYPE integer
USING CAST(CAST(price as numeric) AS integer);

ALTER TABLE realtor_house_listings
ALTER COLUMN bed TYPE integer
USING CAST(bed AS integer);

ALTER TABLE realtor_house_listings
ALTER COLUMN bath TYPE integer
USING CAST(bath AS integer);

ALTER TABLE realtor_house_listings
ALTER COLUMN street_id TYPE integer
USING CAST(CAST(street_id AS numeric) AS integer);

ALTER TABLE realtor_house_listings
ALTER COLUMN house_size TYPE integer
USING CAST(house_size AS integer);

SELECT * FROM realtor_house_listings

-- Finding the average price, bed's, and baths per state from the realtor dataset

SELECT state, ROUND(AVG(price), 2) AS average_price, ROUND(AVG(bed)) AS bed, ROUND(AVG(bath)) AS bath 
FROM usa_real_estate_staging 
	GROUP BY state 
	ORDER BY average_price DESC
